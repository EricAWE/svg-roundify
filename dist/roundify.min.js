!function(){"use strict";function t(){function t(t,n){var i=n.append('<svg class="svg-round"></svg>').children();i.roundify(t.config.data,t.config.options)}var n={link:t,restrict:"E",scope:{config:"=",svgId:"=svgId"}};return n}angular.module("svgRoundify",[]).directive("svgRoundify",t),t.$inject=["$filter","$document"]}(),function(t){var n=function(t,n,i,e,a,o,r){function s(t,n,i,e){var a=(e-90)*Math.PI/180;return{x:t+i*Math.cos(a),y:n+i*Math.sin(a)}}function c(t,n,i,e,a){var o=s(t,n,i,a),r=s(t,n,i,e),c=180>=a-e?"0":"1",f=["M",o.x,o.y,"A",i,i,0,c,0,r.x,r.y].join(" ");return f}var f=this,g=a;this.endPoint=0,this.init=function(){var a=t.color||i,o=t.percent,r=o/100*360,s=5;f.from=c(e.pos.x,e.pos.y,e.radius,n+s,n+s),f.path=c(e.pos.x,e.pos.y,e.radius,n+s,n+r-s),f.loopLength=Snap.path.getTotalLength(f.path),f.endPoint=n+r,f.draw=g.path({stroke:a,fillOpacity:0,strokeWidth:0,strokeLinecap:"round"})},this.getEndPoint=function(){return f.endPoint},this.init()};t.Arc=n}(window),function(t){var n=function(t){var n=this,i=t;this.init=function(t,i){this.configs=i,this.data=t;var e=this.constructLegend(t,n.configs.colors);return"right"===i.pos.name?e.attr({transform:"translate(0, -"+(e.getBBox().height/2-10)+")"}):e.attr({transform:"translate(-"+e.getBBox().width/2+", 0)"}),e.animate({opacity:1},600),e},this.constructLegend=function(t,e){var a=i.g().attr({opacity:0}),o=n.configs.pos.x,r=n.configs.pos.y,s=n.getLegendMinWidth(t,n.configs);return t.forEach(function(t,c){var f=t.color||e[c],g=i.circle(o,r-5,5).attr({fill:f}),h=i.text(o+20,r,t.name).attr({fontFamily:n.configs.font.fontFamily,fontSize:n.configs.font.fontSize,fill:n.configs.font.fill}),l=i.text(o+s,r,t.value.toString()).attr({fontFamily:n.configs.font.fontFamily,fontSize:n.configs.font.fontSize,fill:n.configs.font.fill,fontWeight:"700",textAnchor:"end"});a.add(i.g(g,h,l)),r+=2*parseInt(n.configs.font.fontSize,10)}),a},this.getLegendMinWidth=function(t,n){var i=0,e=0;return t.forEach(function(t){i=t.name.length*n.font.fontSize.split("px")[0]+90,i>e&&(e=i)}),e},this.getLegendMinHeight=function(t,n){var i=0;return t.forEach(function(){i+=parseInt(n.font.fontSize.split("px")[0])+10}),i+40}};t.Legend=n}(window),function(t){var n=function(t,n,i){this.init=function(n){var i=t.g(),e=n.circle.radius/2;i.attr({transform:"translate("+n.circle.pos.x+", "+(n.circle.pos.y+n.circle.radius+e/4)+")"});var a=t.text(0,0,[n.mainData.value,n.mainData.unit]).attr({fontFamily:n.legend.font.fontFamily,fontSize:"14px",fill:n.legend.font.fill,textAnchor:"middle"});return a.select("tspan").attr({fontSize:e+"px"}),i.add(a),i}};t.MainData=n}(window),function(t){"use strict";var n=function(t,n,i){function e(){var t=r.arcs;Snap.animate(0,t[s].loopLength,function(n){t[s].draw.attr({path:Snap.path.getSubpath(t[s].path,0,n),transform:"translate(0 "+(r.configs.radius+40)+") scale(1, 1)",strokeWidth:r.configs.stroke})},400,mina.easeInOut,function(){s>0&&(s--,r.animate())})}function a(){var t=r.arcs;t.forEach(function(t){Snap.animate(0,t.loopLength,function(n){t.draw.attr({path:Snap.path.getSubpath(t.path,0,n),transform:"translate(0 "+r.configs.radius+") scale(1, 1)",strokeWidth:r.configs.stroke})},400,mina.easeInOut)})}function o(){var t=r.arcs;t.forEach(function(t){t.draw.attr({path:Snap.path.getSubpath(t.path,0,t.loopLength),transform:"translate(0 "+(r.configs.radius+40)+") scale(1, 1)",strokeWidth:r.configs.stroke})})}var r=this,s=0,c=t;this.arcs=[],this.configs={},this.init=function(e,a){this.configs=a;var o=c.g(),f=this.convertToPercent(e),g=0;return f.forEach(function(e,a){e.percent>2&&(r.arcs.push(new Arc(e,r.configs.nowPoint,r.configs.colors[a],r.configs,t,n,i)),r.configs.nowPoint=r.arcs[g].getEndPoint(),o.add(r.arcs[g].draw),g++)}),s=r.arcs.length-1,setTimeout(function(){r.animate()},200),o},this.convertToPercent=function(t){var n=_.sum(t,function(t){return t.value});return t.forEach(function(i,e){t[e].percent=100*i.value/n}),t},this.animate=function(){switch(r.configs.animation.type){case"smooth":e();break;case"parallel":a();break;case"none":o();break;default:o()}}};t.RoundifyCircle=n}(window),function(){"use strict";var t=function(t,n,i){function e(){var t=0;if("right"===g.configs.legend.pos){var i=g.legend.getLegendMinWidth(n,g.configs.legend);t=r>=s?s/2-2*g.configs.padding:r/2-2*g.configs.padding,2*t>r-i&&(t=(r-i)/2-2*g.configs.padding)}else{var e=g.legend.getLegendMinHeight(n,g.configs.legend);t=(s-e-40)/2,2*t>r-40&&(t=(r-40)/2)}return t}function a(t){var n;switch(t){case"right":n={circle:{x:g.configs.padding+g.configs.legend.radius,y:(s-2*g.configs.circle.radius)/2,name:"right"},legend:{x:2*g.configs.legend.radius+50,y:f,name:"right"}};break;case"bottom":n={circle:{x:c,y:g.configs.padding,name:"bottom"},legend:{x:c,y:g.configs.padding+2*g.configs.circle.radius+60,name:"bottom"}};break;default:n={x:c,y:f}}return n}var o,r,s,c,f,g=this;this.chart=null,this.configs={},this.round=null,this.legend=null,this.mainData=null,this.chart=null,this["default"]=null,this.initVariables=function(){o=Snap(t[0]),r=i.width||t.prop("offsetWidth"),s=i.height||t.prop("offsetHeight"),c=r/2,f=s/2,this.round=new RoundifyCircle(o,c,f),this.legend=new Legend(o,c,f),this.mainData=new MainData(o,c,f),this["default"]={padding:20,circle:{pos:"center",nowPoint:0,stroke:8,colors:["#3498db","#1abc9c","#9b59b6"],animation:{type:"parallel"}},legend:{pos:"right",colors:["#3498db","#1abc9c","#9b59b6"],font:{fontFamily:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14px",fill:"#575757"}},mainData:{}}},this.init=function(){this.first=this.first?!1:!0,this.initVariables(),this.configs=i?this.extend(this["default"],i):this["default"],this.configs.circle.radius=e(),this.configs.legend.radius=this.configs.circle.radius,c=(g.configs.width||r)/2,f=(g.configs.height||s)/2;var t=a(g.configs.legend.pos||!1);this.chart=o.g(),this.configs.circle.pos=t.circle,this.configs.legend.pos=t.legend;var h=this.round.init(n,g.configs.circle),l=this.legend.init(n,g.configs.legend);if(this.configs.mainData&&this.configs.mainData.value){var d=this.mainData.init(g.configs);this.chart.append(d)}this.chart.append(h),this.chart.append(l)},this.extend=function(t){for(var n=t||{},i=1;i<arguments.length;i++){var e=arguments[i];if(e)for(var a in e)e.hasOwnProperty(a)&&("object"==typeof e[a]?g.extend(n[a],e[a]):n[a]=e[a])}return n},this.init()},n=angular.element;n.prototype.roundify=function(i,e){var a=this;return this.round=new t(this,i,e),n(window).on("resize",function(){a.round.chart.remove(),a.round.init()}),this}}();