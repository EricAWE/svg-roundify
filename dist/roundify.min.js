"use strict";!function(t){var n=function(t,n,i,e,o,a,s){function r(t,n,i,e){var o=(e-90)*Math.PI/180;return{x:t+i*Math.cos(o),y:n+i*Math.sin(o)}}function c(t,n,i,e,o){var a=r(t,n,i,o),s=r(t,n,i,e),c=180>=o-e?"0":"1",f=["M",a.x,a.y,"A",i,i,0,c,0,s.x,s.y].join(" ");return f}var f=this,h=o;this.endPoint=0,this.init=function(){var o=t.percent,a=o/100*360,s=5;f.from=c(e.pos.x,e.pos.y,e.radius,n+s,n+s),f.path=c(e.pos.x,e.pos.y,e.radius,n+s,n+a-s),f.loopLength=Snap.path.getTotalLength(f.path),f.endPoint=n+a,f.draw=h.path({stroke:i,fillOpacity:0,strokeWidth:0,strokeLinecap:"round"})},this.getEndPoint=function(){return f.endPoint},this.init()};t.Arc=n}(window),function(t){var n=function(t,n,i){var e=this,o=t;this.init=function(t,n){this.configs=n,this.data=t,console.log(n);var i=this.constructLegend(t,e.configs.colors);i.attr({transform:"translate(0, -"+i.getBBox().height/2+")"}).animate({opacity:1},600)},this.constructLegend=function(t,n){var i=o.g().attr({opacity:0}),a=e.configs.pos.x,s=e.configs.pos.y;return t.forEach(function(t,r){var c=o.circle(a,s-5,5).attr({fill:n[r]}),f=o.text(a+20,s,t.name).attr({fontFamily:e.configs.font.fontFamily,fontSize:e.configs.font.fontSize,fill:e.configs.font.fill}),h=o.text(a+200,s,t.value).attr({fontFamily:e.configs.font.fontFamily,fontSize:e.configs.font.fontSize,fill:e.configs.font.fill,fontWeight:"700",textAnchor:"end"});i.add(o.g(c,f,h)),s+=2*parseInt(e.configs.font.fontSize,10)}),i}};t.Legend=n}(window),function(t){var n=function(t,n,i){};t.MainData=n}(window),function(t){var n=function(t,n,i){function e(){var t=s.arcs;Snap.animate(0,t[r].loopLength,function(n){t[r].draw.attr({path:Snap.path.getSubpath(t[r].path,0,n),transform:"translate("+2*s.configs.pos.x+"), scale(-1, 1)",strokeWidth:s.configs.stroke})},400,mina.easeInOut,function(){r>0&&(r--,s.animate())})}function o(){var t=s.arcs;t.forEach(function(t){Snap.animate(0,t.loopLength,function(n){t.draw.attr({path:Snap.path.getSubpath(t.path,0,n),transform:"translate("+2*s.configs.pos.x+"), scale(-1, 1)",strokeWidth:s.configs.stroke})},400,mina.easeInOut)})}function a(){var t=s.arcs;t.forEach(function(t){t.draw.attr({path:Snap.path.getSubpath(t.path,0,t.loopLength),transform:"translate("+2*s.configs.pos.x+"), scale(-1, 1)",strokeWidth:s.configs.stroke})})}var s=this,r=0;this.arcs=[],this.configs={},this.init=function(e,o){this.configs=o;var a=this.convertToPercent(e);a.forEach(function(e,o){s.arcs.push(new Arc(e,s.configs.nowPoint,s.configs.colors[o],s.configs,t,n,i)),s.configs.nowPoint=s.arcs[o].getEndPoint()}),r=s.arcs.length-1,setTimeout(function(){s.animate()},200)},this.convertToPercent=function(t){var n=_.sum(t,function(t){return t.value});return t.forEach(function(i,e){t[e].percent=100*i.value/n}),t},this.animate=function(){switch(s.configs.animation.type){case"smooth":e();break;case"parallel":o();break;default:a()}}};t.RoundifyCircle=n}(window);var paper=Snap("#svg"),centerXP=document.getElementById("svg").offsetWidth/2,centerYP=document.getElementById("svg").offsetHeight/2,Roundify=function(t,n){function i(t){var n;switch(t){case"right":n={circle:{x:10+e.configs.legend.radius,y:centerYP},legend:{x:2*e.configs.legend.radius+50,y:centerYP}};break;case"bottom":n={x:centerXP,y:10+e.configs.legend.radius};break;default:n={x:centerXP,y:centerYP}}return n}var e=this;this.configs={},this.round=new RoundifyCircle,this.legend=new Legend,this.mainData=new MainData,this["default"]={circle:{pos:"center",radius:100,nowPoint:0,stroke:8,colors:["#3498db","#1abc9c","#9b59b6"],animation:{type:"parallel"}},legend:{pos:"right",colors:["#3498db","#1abc9c","#9b59b6"],font:{fontFamily:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14px",fill:"#575757"}},mainData:{value:"32%"}},this.init=function(){this.configs=n?this.extend(this["default"],n):this["default"],this.configs.legend.radius=this.configs.circle.radius;var o=i(e.configs.legend.pos||!1);this.configs.circle.pos=o.circle,this.configs.legend.pos=o.legend,this.round.init(t,e.configs.circle),this.legend.init(t,e.configs.legend)},this.extend=function(t){for(var n=t||{},i=1;i<arguments.length;i++){var o=arguments[i];if(o)for(var a in o)o.hasOwnProperty(a)&&("object"==typeof o[a]?e.extend(n[a],o[a]):n[a]=o[a])}return n},this.init()},MainData=function(){},Legend=function(){var t=this;this.init=function(n,i){this.configs=i,this.data=n,console.log(i);var e=this.constructLegend(n,t.configs.colors);e.attr({transform:"translate(0, -"+e.getBBox().height/2+")"}).animate({opacity:1},600)},this.constructLegend=function(n,i){var e=paper.g().attr({opacity:0}),o=t.configs.pos.x,a=t.configs.pos.y;return n.forEach(function(n,s){var r=paper.circle(o,a-5,5).attr({fill:i[s]}),c=paper.text(o+20,a,n.name).attr({fontFamily:t.configs.font.fontFamily,fontSize:t.configs.font.fontSize,fill:t.configs.font.fill}),f=paper.text(o+200,a,n.value).attr({fontFamily:t.configs.font.fontFamily,fontSize:t.configs.font.fontSize,fill:t.configs.font.fill,fontWeight:"700",textAnchor:"end"});e.add(paper.g(r,c,f)),a+=2*parseInt(t.configs.font.fontSize)}),e}},RoundifyCircle=function(){function t(){var t=e.arcs;Snap.animate(0,t[o].loopLength,function(n){t[o].draw.attr({path:Snap.path.getSubpath(t[o].path,0,n),transform:"translate("+2*e.configs.pos.x+"), scale(-1, 1)",strokeWidth:e.configs.stroke})},400,mina.easeInOut,function(){o>0&&(o--,e.animate())})}function n(){var t=e.arcs;t.forEach(function(t){Snap.animate(0,t.loopLength,function(n){t.draw.attr({path:Snap.path.getSubpath(t.path,0,n),transform:"translate("+2*e.configs.pos.x+"), scale(-1, 1)",strokeWidth:e.configs.stroke})},400,mina.easeInOut)})}function i(){var t=e.arcs;t.forEach(function(t){t.draw.attr({path:Snap.path.getSubpath(t.path,0,t.loopLength),transform:"translate("+2*e.configs.pos.x+"), scale(-1, 1)",strokeWidth:e.configs.stroke})})}var e=this,o=0;this.arcs=[],this.configs={},this.init=function(t,n){this.configs=n;var i=this.convertToPercent(t);i.forEach(function(t,n){e.arcs.push(new Arc(t,e.configs.nowPoint,e.configs.colors[n],e.configs)),e.configs.nowPoint=e.arcs[n].getEndPoint()}),o=e.arcs.length-1,setTimeout(function(){e.animate()},200)},this.convertToPercent=function(t){var n=_.sum(t,function(t){return t.value});return t.forEach(function(i,e){t[e].percent=100*i.value/n}),t},this.animate=function(){switch(e.configs.animation.type){case"smooth":t();break;case"parallel":n();break;default:i()}}},Arc=function(t,n,i,e){function o(t,n,i,e){var o=(e-90)*Math.PI/180;return{x:t+i*Math.cos(o),y:n+i*Math.sin(o)}}function a(t,n,i,e,a){var s=o(t,n,i,a),r=o(t,n,i,e),c=180>=a-e?"0":"1",f=["M",s.x,s.y,"A",i,i,0,c,0,r.x,r.y].join(" ");return f}var s=this;this.endPoint=0,this.init=function(){var o=t.percent,r=o/100*360,c=5;s.from=a(e.pos.x,e.pos.y,e.radius,n+c,n+c),s.path=a(e.pos.x,e.pos.y,e.radius,n+c,n+r-c),s.loopLength=Snap.path.getTotalLength(s.path),s.endPoint=n+r,s.draw=paper.path({stroke:i,fillOpacity:0,strokeWidth:0,strokeLinecap:"round"})},this.getEndPoint=function(){return s.endPoint},this.init()},paper=Snap("#svg"),centerXP=document.getElementById("svg").offsetWidth/2,centerYP=document.getElementById("svg").offsetHeight/2,Roundify=function(t,n){function i(t){var n;switch(t){case"right":n={circle:{x:10+e.configs.legend.radius,y:centerYP},legend:{x:2*e.configs.legend.radius+50,y:centerYP}};break;case"bottom":n={x:centerXP,y:10+e.configs.legend.radius};break;default:n={x:centerXP,y:centerYP}}return n}var e=this;this.configs={},this.round=new RoundifyCircle(paper,centerXP,centerYP),this.legend=new Legend(paper,centerXP,centerYP),this.mainData=new MainData(paper,centerXP,centerYP),this["default"]={circle:{pos:"center",radius:100,nowPoint:0,stroke:8,colors:["#3498db","#1abc9c","#9b59b6"],animation:{type:"parallel"}},legend:{pos:"right",colors:["#3498db","#1abc9c","#9b59b6"],font:{fontFamily:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14px",fill:"#575757"}},mainData:{value:"32%"}},this.init=function(){this.configs=n?this.extend(this["default"],n):this["default"],this.configs.legend.radius=this.configs.circle.radius;var o=i(e.configs.legend.pos||!1);this.configs.circle.pos=o.circle,this.configs.legend.pos=o.legend,this.round.init(t,e.configs.circle),this.legend.init(t,e.configs.legend)},this.extend=function(t){for(var n=t||{},i=1;i<arguments.length;i++){var o=arguments[i];if(o)for(var a in o)o.hasOwnProperty(a)&&("object"==typeof o[a]?e.extend(n[a],o[a]):n[a]=o[a])}return n},this.init()};