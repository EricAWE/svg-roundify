!function(){"use strict";function n(){function n(n,t){var i=t.append('<svg class="svg-round"></svg>').children();i.roundify(n.config.data,n.config.options)}var t={link:n,restrict:"E",scope:{config:"=",svgId:"=svgId"}};return t}angular.module("svgRoundify",[]).directive("svgRoundify",n),n.$inject=["$filter","$document"]}(),function(n){var t=function(n,t,i,a,o,e,s){function r(n,t,i,a){var o=(a-90)*Math.PI/180;return{x:n+i*Math.cos(o),y:t+i*Math.sin(o)}}function c(n,t,i,a,o){var e=r(n,t,i,o),s=r(n,t,i,a),c=180>=o-a?"0":"1",f=["M",e.x,e.y,"A",i,i,0,c,0,s.x,s.y].join(" ");return f}var f=this,g=o;this.endPoint=0,this.init=function(){var o=n.color||i,e=n.percent,s=e/100*360,r=5;f.from=c(a.pos.x,a.pos.y,a.radius,t+r,t+r),f.path=c(a.pos.x,a.pos.y,a.radius,t+r,t+s-r),f.loopLength=Snap.path.getTotalLength(f.path),f.endPoint=t+s,f.draw=g.path({stroke:o,fillOpacity:0,strokeWidth:0,strokeLinecap:"round"})},this.getEndPoint=function(){return f.endPoint},this.init()};n.Arc=t}(window),function(n){var t=function(n){var t=this,i=n;this.init=function(n,i){this.configs=i,this.data=n;var a=this.constructLegend(n,t.configs.colors);return a.attr({transform:"translate(0, -"+(a.getBBox().height/2-10)+")"}).animate({opacity:1},600),a},this.constructLegend=function(n,a){var o=i.g().attr({opacity:0}),e=t.configs.pos.x,s=t.configs.pos.y,r=t.getLegendMinWidth(n,t.configs);return n.forEach(function(n,c){var f=n.color||a[c],g=i.circle(e,s-5,5).attr({fill:f}),h=i.text(e+20,s,n.name).attr({fontFamily:t.configs.font.fontFamily,fontSize:t.configs.font.fontSize,fill:t.configs.font.fill}),d=i.text(e+r,s,n.value.toString()).attr({fontFamily:t.configs.font.fontFamily,fontSize:t.configs.font.fontSize,fill:t.configs.font.fill,fontWeight:"700",textAnchor:"end"});o.add(i.g(g,h,d)),s+=2*parseInt(t.configs.font.fontSize,10)}),o},this.getLegendMinWidth=function(n,t){var i=0,a=0;return n.forEach(function(n){i=n.name.length*t.font.fontSize.split("px")[0]+90,i>a&&(a=i)}),a}};n.Legend=t}(window),function(n){var t=function(n,t,i){this.init=function(t){var a=n.g(),o=t.circle.radius/2;a.attr({transform:"translate("+t.circle.pos.x+", "+(i+o/4)+")"});var e=n.text(0,0,[t.mainData.value,t.mainData.unit]).attr({fontFamily:t.legend.font.fontFamily,fontSize:"14px",fill:t.legend.font.fill,textAnchor:"middle"});return e.select("tspan").attr({fontSize:o+"px"}),a.add(e),a}};n.MainData=t}(window),function(n){"use strict";var t=function(n,t,i){function a(){var n=s.arcs;Snap.animate(0,n[r].loopLength,function(t){n[r].draw.attr({path:Snap.path.getSubpath(n[r].path,0,t),transform:"translate(0 "+(s.configs.radius+40)+") scale(1, 1)",strokeWidth:s.configs.stroke})},400,mina.easeInOut,function(){r>0&&(r--,s.animate())})}function o(){var n=s.arcs;n.forEach(function(n){Snap.animate(0,n.loopLength,function(t){n.draw.attr({path:Snap.path.getSubpath(n.path,0,t),transform:"translate(0 "+(s.configs.radius+40)+") scale(1, 1)",strokeWidth:s.configs.stroke})},400,mina.easeInOut)})}function e(){var n=s.arcs;n.forEach(function(n){n.draw.attr({path:Snap.path.getSubpath(n.path,0,n.loopLength),transform:"translate(0 "+(s.configs.radius+40)+") scale(1, 1)",strokeWidth:s.configs.stroke})})}var s=this,r=0,c=n;this.arcs=[],this.configs={},this.init=function(a,o){this.configs=o;var e=c.g(),f=this.convertToPercent(a),g=0;return f.forEach(function(a,o){a.percent>2&&(s.arcs.push(new Arc(a,s.configs.nowPoint,s.configs.colors[o],s.configs,n,t,i)),s.configs.nowPoint=s.arcs[g].getEndPoint(),e.add(s.arcs[g].draw),g++)}),r=s.arcs.length-1,setTimeout(function(){s.animate()},200),e},this.convertToPercent=function(n){var t=_.sum(n,function(n){return n.value});return n.forEach(function(i,a){n[a].percent=100*i.value/t}),n},this.animate=function(){switch(s.configs.animation.type){case"smooth":a();break;case"parallel":o();break;case"none":e();break;default:e()}}};n.RoundifyCircle=t}(window),function(){"use strict";var n=function(n,t,i){function a(){var n=0,i=g.legend.getLegendMinWidth(t,g.configs.legend);return n=s>=r?r/2-2*g.configs.padding:s/2-2*g.configs.padding,2*n>s-i&&(n=(s-i)/2-2*g.configs.padding),n}function o(n){var t;switch(n){case"right":t={circle:{x:g.configs.padding+g.configs.legend.radius,y:(r-2*g.configs.circle.radius)/2-2*g.configs.padding},legend:{x:2*g.configs.legend.radius+50,y:f}};break;case"bottom":t={circle:{x:c,y:g.configs.padding+g.configs.legend.radius},legend:{x:c,y:g.configs.padding+2*g.configs.legend.radius}};break;default:t={x:c,y:f}}return t}var e,s,r,c,f,g=this;this.chart=null,this.configs={},this.round=null,this.legend=null,this.mainData=null,this.chart=null,this["default"]=null,this.initVariables=function(){e=Snap(n[0]),s=i.width||n.prop("offsetWidth"),r=i.height||n.prop("offsetHeight"),c=s/2,f=r/2,this.round=new RoundifyCircle(e,c,f),this.legend=new Legend(e,c,f),this.mainData=new MainData(e,c,f),this["default"]={padding:20,circle:{pos:"center",nowPoint:0,stroke:8,colors:["#3498db","#1abc9c","#9b59b6"],animation:{type:"parallel"}},legend:{pos:"right",colors:["#3498db","#1abc9c","#9b59b6"],font:{fontFamily:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:"14px",fill:"#575757"}},mainData:{}}},this.init=function(){this.first=this.first?!1:!0,this.initVariables(),this.configs=i?this.extend(this["default"],i):this["default"],this.configs.circle.radius=a(),this.configs.legend.radius=this.configs.circle.radius,c=(g.configs.width||s)/2,f=(g.configs.height||r)/2;var n=o(g.configs.legend.pos||!1);this.chart=e.g(),this.configs.circle.pos=n.circle,this.configs.legend.pos=n.legend;var h=this.round.init(t,g.configs.circle),d=this.legend.init(t,g.configs.legend);if(this.configs.mainData&&this.configs.mainData.value){var u=this.mainData.init(g.configs);this.chart.append(u)}this.chart.append(h),this.chart.append(d)},this.extend=function(n){for(var t=n||{},i=1;i<arguments.length;i++){var a=arguments[i];if(a)for(var o in a)a.hasOwnProperty(o)&&("object"==typeof a[o]?g.extend(t[o],a[o]):t[o]=a[o])}return t},this.init()},t=angular.element;t.prototype.roundify=function(i,a){var o=this;return this.round=new n(this,i,a),t(window).on("resize",function(){o.round.chart.remove(),o.round.init()}),this}}();